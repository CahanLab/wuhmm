#summary wuHMM instructions

The example R session below describes the process of loading NimbleGen data files, using wuHMM, and plotting the results.  The data files used in the examples below are available for download from [http://compbio.s3.amazonaws.com/demoData.zip here].  Download and decompress (unzip) the compressed demo data file in the same directory that you placed the wuHMM code files.  This data is also available at GEO under accession [http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE5805 GSE5805].  Download the sample text file that contains the demo sample data descriptions [http://wuhmm.googlecode.com/files/project.txt here].

Launch R.   The following R commands will get you started reading NimbleGen data, and detecting and plotting CNV predictions.  Lines begining with '>' are commands, '#' are comments.
{{{
# read sample file containing sample and file names

> samples<-read.table("project.txt", sep="\t",quote='', header=TRUE, as.is=TRUE)
# iPos = 5
# iChr = 3
# iSignal = 14
# cols = 14
> loadSamples(samples,iPos=5,iSignal=14,iChr=3,ncols=14,autos=c(1:19),sex=c(TRUE,TRUE), prepend0=0)

# decode Chr7
> system.time(cnvs7<-decodeAndPerm(samples$sample_name,chrs=7, nstay_seed=3))
AJ
Balb_cByJ
C57BL_6J
C58_J
DBA_2J
[1]  48.35  70.01 417.00 163.55 123.97
> dim(cnvs7)
[1] 141   9

# filter out low-scoring calls
> cnvs7<-filterCalls(cnvs7, 1.5, 1.5)
> dim(cnvs7)
[1] 25  9

# merge CNVs into CNV-regions (CNVRs)
> cnvrs7<-makeCNVRs(cnvs7, 1)
> dim(cnvrs7[[1]])
[1] 17  6

# Genotype CNVRs
> g7<-w_genotype(samples$sample_name, cnvrs7[[2]], cnvrs7[[1]])
}}}